<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>Ellen's Playground</title>

    <script src="../blockly_uncompressed_vertical.js"></script>
    <script src="../msg/messages.js"></script>
    
    <script src="../blocks_vertical/vertical_extensions.js"></script>
    
    <script src="../blocks_common/math.js"></script>
    <script src="../blocks_common/text.js"></script>
    <script src="../blocks_common/colour.js"></script>
    <script src="../blocks_vertical/control.js"></script>
    <script src="../blocks_vertical/event.js"></script>
    <script src="../blocks_vertical/motion.js"></script>
    <script src="../blocks_vertical/looks.js"></script>
    <script src="../blocks_vertical/procedures.js"></script>
    <script src="../blocks_vertical/operators.js"></script>
    <script src="../blocks_vertical/pen.js"></script>
    <script src="../blocks_vertical/sound.js"></script>
    <script src="../blocks_vertical/sensing.js"></script>
    <script src="../blocks_vertical/data.js"></script>
    <script src="../blocks_ellen/superpowers.js"></script>

    <script src="../blocks_ellen/ellen_toolbox.js"></script>


    <script>
      'use strict';
	
      var workspace = null;
      
    
      function start() {
    	  console.log("started");
    	  
    	  
    	  //Blockly.Blocks.defaultToolbox = '<xml id="toolbox-categories" style="display: none"></xml>'
    	  
          workspace = Blockly.inject('blocklyDiv', {
        	  toolbox:'<xml></xml>',
        	  'scrollbars': false,
        	  'trashcan': false
            });
    	
    	  console.log(Blockly.mainWorkspace.getFlyout());
    	  //explicitly hide the flyout (why??)
    	  //x=o is not  totally left.
    	  Blockly.mainWorkspace.getFlyout().hide();
    	  
    	  
    	  insertSomeCode()
    	  insertSomeCodeFromXML()
      }
      
      function insertSomeCodeFromXML(){
	      var xml = ['<xml xmlns="http://www.w3.org/1999/xhtml">',
		    	  '<variables></variables>',
		    	  '<block type="event_whenflagclicked" id="=qJ!3j:]}%#jLwzu5*y~" x="0" y="100">',
		    	  ' <next>',
		    	  '    <block type="motion_movesteps" id="gD}#U^lwZX=SAlVMW[{m">',
		    	  '      <value name="STEPS">',
		    	  '        <shadow type="math_number" id="UqK4,K.m0*X#`PnglZD[">',
		    	  '          <field name="NUM">10</field>',
		    	  '        </shadow>',
		    	  '      </value>',
		    	  '    </block>',
		    	  '  </next>',
		    	  '</block>',
	    		'</xml>'].join('\n');
	      var dom = Blockly.Xml.textToDom(xml);
	      Blockly.Xml.domToWorkspace(dom, workspace);
      }
		    	  
	function addBlock(prototypeName,id,x,y){
  	  var block = workspace.newBlock(prototypeName, id);
	  
	  block.initSvg();
	  
	  block.setMovable(false);
	  block.setEditable(false);
	  
	  block.moveBy(x,y);
	  
	  block.render();
	  
	  console.log(block);
	}		    	  
		    	  
      function insertSomeCode(){
    	  //https://developers.google.com/blockly/reference/js/Blockly.Block#setDisabled
    	  
    	  var prototypeName = 'superpowers_jump';
    	  var id = 'UqK4,K.j0*X#`PnglZD[';
    	  addBlock(prototypeName,id,-200,40);
    	  
    	  addBlock('superpowers_fly_away','UqK4,K.p0*X#`PnglZD[',0,90);
    	  
    	  
    	  addBlock('superpowers_bat_signal','UoK4,K.p0*X#`PnglZD[',100,250);
    	  
    	  addBlock('superpowers_while_awesome','UoK4,K.p0*X#`PntlZD[',400,250);

    	  
      }
    </script>

    <style>
      html, body {
        height: 100%;
      }

      body {
        background-color: #fff;
        font-family: sans-serif;
        overflow: hidden;
      }

      h1 {
        font-weight: normal;
        font-size: 140%;
      }

      #blocklyDiv {
        float: left;
        height: 100%;
        width: 100%;
      }
      
      


    </style>
  </head>

  <body onload="start()">
   <!-- <input type="button" value="insert some code" onclick="insertSomeCode()">  -->
   <div id="blocklyDiv"></div>
  </body>
</html>
